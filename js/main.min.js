const AUTHOR_NAME='Korosium';const AVAILABLE_HASH_FUNCTIONS={'Old':['MD2','MD4','MD5'],'SHA-1':['SHA-1',],'SHA-2':['SHA-224','SHA-256','SHA-384','SHA-512','SHA-512/224','SHA-512/256'],'SHA-3':['SHA3-224','SHA3-256','SHA3-384','SHA3-512','SHAKE128','SHAKE256']};const AVAILABLE_HASH_ENCODING=['Binary','Octal','Hex','Base32 (RFC-4648)','Base32 (Extended hex)','Base32 (z-base)','Base32 (Crockford)','Base64'];const hash_algorithm_select=document.getElementById('hash-algorithm-select');const hash_encoding_select=document.getElementById('hash-encoding-select');const hash_rounds_input=document.getElementById('hash-rounds-input');const hash_output_length_input=document.getElementById('hash-output-length-input');const hash_algorithm_div=document.getElementById('hash-algorithm-div');const hash_encoding_div=document.getElementById('hash-encoding-div');const hash_rounds_div=document.getElementById('hash-rounds-div');const hash_output_length_div=document.getElementById('hash-output-length-div');const text_textarea=document.getElementById('text-textarea');const file_input=document.getElementById('file-input');const checksum_input=document.getElementById('checksum-input');const checksum_input_label=document.getElementById('checksum-input-label');let stored_checksum=[];hash_algorithm_select.onchange=()=>hash_the_right_input();hash_encoding_select.onchange=()=>change_encoding();hash_rounds_input.oninput=()=>hash_the_right_input();hash_output_length_input.oninput=()=>hash_the_right_input();text_textarea.oninput=()=>hash_text();file_input.oninput=()=>hash_file();checksum_input.onclick=()=>navigator.clipboard.writeText(checksum_input.value);const hash_the_right_input=()=>{if(hash_algorithm_select.value===AVAILABLE_HASH_FUNCTIONS['SHA-3'][4]||hash_algorithm_select.value===AVAILABLE_HASH_FUNCTIONS['SHA-3'][5]){hash_algorithm_div.classList.remove('col-lg-4');hash_algorithm_div.classList.add('col-lg-3');hash_encoding_div.classList.remove('col-lg-4');hash_encoding_div.classList.add('col-lg-3');hash_rounds_div.classList.remove('col-lg-4');hash_rounds_div.classList.add('col-lg-3');hash_output_length_div.style.display='inline-block';}else{hash_algorithm_div.classList.remove('col-lg-3');hash_algorithm_div.classList.add('col-lg-4');hash_encoding_div.classList.remove('col-lg-3');hash_encoding_div.classList.add('col-lg-4');hash_rounds_div.classList.remove('col-lg-3');hash_rounds_div.classList.add('col-lg-4');hash_output_length_div.style.display='none';}clamp_rounds_value();clamp_output_length_value();if(file_input.files.length>0)hash_file();else hash_text();};const hash_text=()=>{file_input.value='';stored_checksum=hash_with_right_algo_and_rounds(text_textarea.value,hash_algorithm_select.value,hash_rounds_input.value,hash_output_length_input.value);show_hash_on_screen(hash_encoding_select.value);};const hash_file=()=>{text_textarea.value='';checksum_input.value='Hashing...';const fr=new FileReader();fr.readAsArrayBuffer(file_input.files[0]);fr.onload=()=>{stored_checksum=hash_with_right_algo_and_rounds(fr.result,hash_algorithm_select.value,hash_rounds_input.value,hash_output_length_input.value);show_hash_on_screen(hash_encoding_select.value);};fr.onerror=()=>{console.log(fr.error);}};const clamp_rounds_value=()=>{let rounds=parseInt(hash_rounds_input.value);if(isNaN(rounds))hash_rounds_input.value=1;else if(rounds<1)hash_rounds_input.value=1;else if(rounds>10000)hash_rounds_input.value=10000;};const clamp_output_length_value=()=>{let length=parseInt(hash_output_length_input.value);if(isNaN(length))hash_output_length_input.value=8;else if(length<8)hash_output_length_input.value=8;else if(length>8192)hash_output_length_input.value=8192;else hash_output_length_input.value=length-length%8};const hash_with_right_algo_and_rounds=(data,algo,rounds,output_length)=>{let retval=hash_once(data,algo,output_length);for(let i=1;i<rounds;i++)retval=hash_once(retval,algo,output_length);return retval;};const hash_once=(data,algo,output_length)=>{switch(algo){case AVAILABLE_HASH_FUNCTIONS['Old'][0]:return md2.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['Old'][1]:return md4.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['Old'][2]:return md5.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-1'][0]:return sha1.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-2'][0]:return sha224.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-2'][1]:return sha256.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-2'][2]:return sha384.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-2'][3]:return sha512.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-2'][4]:return sha512_224.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-2'][5]:return sha512_256.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-3'][0]:return sha3_224.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-3'][1]:return sha3_256.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-3'][2]:return sha3_384.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-3'][3]:return sha3_512.hash.array(data);case AVAILABLE_HASH_FUNCTIONS['SHA-3'][4]:return shake128.hash.array(data,output_length/8);case AVAILABLE_HASH_FUNCTIONS['SHA-3'][5]:return shake256.hash.array(data,output_length/8);}};const show_hash_on_screen=(encoding)=>{let retval='';switch(encoding){case AVAILABLE_HASH_ENCODING[0]:retval=to_binary(stored_checksum);break;case AVAILABLE_HASH_ENCODING[1]:retval=to_octal(stored_checksum);break;case AVAILABLE_HASH_ENCODING[2]:retval=to_hex(stored_checksum);break;case AVAILABLE_HASH_ENCODING[3]:retval=base32.RFC_4648.encode(stored_checksum);break;case AVAILABLE_HASH_ENCODING[4]:retval=base32.BASE_32_HEX.encode(stored_checksum);break;case AVAILABLE_HASH_ENCODING[5]:retval=base32.Z_BASE_32.encode(stored_checksum);break;case AVAILABLE_HASH_ENCODING[6]:retval=base32.CROCKFORD_BASE_32.encode(stored_checksum);break;case AVAILABLE_HASH_ENCODING[7]:retval=btoa(stored_checksum.map(x=>String.fromCharCode(x)).join(''));break;}let rounds='';if(parseInt(hash_rounds_input.value)===2&&hash_algorithm_select.value==='SHA-256')rounds='d';else if(parseInt(hash_rounds_input.value)>1)rounds=` (x${hash_rounds_input.value})`;checksum_input_label.innerHTML=`${hash_algorithm_select.value}${rounds} | ${encoding}`;checksum_input.value=retval;};const change_encoding=()=>{show_hash_on_screen(hash_encoding_select.value);};const to_desired_base=(checksum,radix,padding)=>{let retval='';for(let i=0;i<checksum.length;i++){retval+=checksum[i].toString(radix).padStart(padding,'0');}return retval;};const to_binary=checksum=>to_desired_base(checksum,2,8);const to_octal=checksum=>to_desired_base(checksum,8,3);const to_hex=(checksum)=>to_desired_base(checksum,16,2);const fill_select=(select,array)=>{const type=Object.prototype.toString.call(array);if(type==='[object Object]'){const keys=Object.keys(array);for(let i=0;i<keys.length;i++){const option_group=document.createElement('optgroup');option_group.label=keys[i];option_group.innerHTML=keys[i];for(let j=0;j<array[keys[i]].length;j++){const option=document.createElement('option');option.value=array[keys[i]][j];option.innerHTML=array[keys[i]][j];option_group.append(option);}select.append(option_group);}}else if(type==='[object Array]'){for(let i=0;i<array.length;i++){const option=document.createElement('option');option.value=array[i];option.innerHTML=array[i];select.append(option);}}};const init=()=>{fill_select(hash_algorithm_select,AVAILABLE_HASH_FUNCTIONS);fill_select(hash_encoding_select,AVAILABLE_HASH_ENCODING);hash_rounds_input.min=1;hash_rounds_input.max=10000;hash_output_length_input.min=8;hash_output_length_input.max=8192;hash_algorithm_select.value='SHA-256';hash_encoding_select.value='Hex';hash_rounds_input.value=1;hash_output_length_input.value=256;text_textarea.value='';file_input.value='';hash_the_right_input();document.getElementsByTagName('footer')[0].innerHTML+=`<p>Copyright ${new Date().getFullYear()} ${AUTHOR_NAME}</p>`;};const main=()=>{init();};window.onload=main;